<article class="product">
  <header>
    <%= link_to product do %>
      <%= image_tag product.image.thumb, alt: product.name %>
      <h4><%= product.name %></h4>
    <% end %>
  </header>
  <p class="description">
    <%= product.description %>
    <br>
    <%# <%= product.rating %>
          <%score = Product.find_by(id: product.id)%>
          <%@average_rating = Array.new%>
      <div><% score.rating.each do |f|%>
      <%@average_rating.push(f.rating)%>
      <%end%></div>
      <div class='rating'>
      <%if @average_rating.sum.fdiv(@average_rating.size).to_f.nan?%>
      <%="Not Yet Rated"%>
      <%else%>
      <%="Rating: #{@average_rating.sum.fdiv(@average_rating.size)}"%><%= image_tag "smiling-gold-star.png" %>
      <%end%>
      </div>
  </p>
  <footer class="actions">
    <%= link_to add_item_cart_path(product_id: product.id), class: 'btn btn-primary', method: :put do %>
      <%= fa_icon "shopping-cart", text: 'Add' %>
    <% end %>
    <%= link_to product, class: 'btn btn-default pull-right' do %>
      Details &raquo;
    <% end %>
  </footer>

  <aside class="price">
    <%= humanized_money_with_symbol product.price %>
  </aside>

  <%if product.quantity == 0%>
  <aside class="sold_out">
  SOLD OUT!
  </aside>
  <%end%>

</article>
